<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Resume Tailor</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    
    <!-- Markdown Renderer -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>

    <script>
        // Configure PDF.js Worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        // Configure Tailwind
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#475569',
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        /* Ensure the markdown content uses standard document formatting for better copy-paste */
        .markdown-body {
            /* Basic styling for the resume structure */
            font-family: Arial, sans-serif;
            line-height: 1.4;
            color: #1e293b;
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }
        .markdown-body h1 { font-size: 1.8em; font-weight: bold; margin-top: 0.5em; margin-bottom: 0.25em; color: #0f172a; border-bottom: 2px solid #e2e8f0; padding-bottom: 0.2em; }
        .markdown-body h2 { font-size: 1.4em; font-weight: bold; margin-top: 1.5em; margin-bottom: 0.5em; color: #1e293b; border-bottom: 1px solid #f1f5f9; padding-bottom: 0.2em; }
        .markdown-body h3 { font-size: 1.1em; font-weight: bold; margin-top: 1em; margin-bottom: 0.2em; }
        .markdown-body ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; }
        .markdown-body li { margin-bottom: 0.5em; }
        .markdown-body p { margin-bottom: 1em; line-height: 1.6; }
        .markdown-body strong { font-weight: 700; color: #0f172a; }
        
        .loader {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #3b82f6;
            width: 24px;
            height: 24px;
            -webkit-animation: spin 1s linear infinite; /* Safari */
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- COMPONENTS ---

        const Spinner = () => <div className="loader"></div>;

        const Alert = ({ type, message, onClose }) => {
            if (!message) return null;
            const bgClass = type === 'error' ? 'bg-red-100 text-red-700 border-red-200' : 'bg-green-100 text-green-700 border-green-200';
            return (
                <div className={`p-4 rounded-lg border flex justify-between items-center mb-4 ${bgClass}`}>
                    <span>{message}</span>
                    <button onClick={onClose} className="font-bold hover:opacity-75">Ã—</button>
                </div>
            );
        };

        // --- UTILITY FUNCTIONS ---

        // Function with Exponential Backoff for API calls
        const callGeminiApi = async (url, options) => {
            const maxRetries = 4;
            let delay = 1000; // 1 second initial delay

            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(url, options);
                    const data = await response.json();

                    if (response.status === 429 || (data.error && data.error.message.includes('Quota exceeded') && data.error.message.includes('Please retry'))) {
                        // Rate limit or transient quota error, retry after delay
                        if (i < maxRetries - 1) {
                            await new Promise(resolve => setTimeout(resolve, delay));
                            delay *= 2; // Exponential backoff
                            continue;
                        } else {
                            throw new Error(`API call failed after ${maxRetries} retries: ${data.error?.message || 'Rate limit exceeded.'}`);
                        }
                    }

                    if (!response.ok) {
                        throw new Error(data.error?.message || `API Error: HTTP ${response.status}`);
                    }
                    
                    return data;

                } catch (error) {
                    if (i < maxRetries - 1 && error.message.includes('Failed to fetch')) {
                        // Network error, try again
                        await new Promise(resolve => setTimeout(resolve, delay));
                        delay *= 2;
                        continue;
                    }
                    throw error;
                }
            }
        };


        const App = () => {
            // State
            const [apiKey, setApiKey] = useState('');
            const [jobUrl, setJobUrl] = useState('');
            const [jobDescription, setJobDescription] = useState('');
            const [resumeText, setResumeText] = useState('');
            const [resumeFileName, setResumeFileName] = useState('');
            const [generatedResume, setGeneratedResume] = useState('');
            const resultRef = useRef(null); // Ref for the result div

            // Model State
            const defaultModel = 'gemini-2.5-flash-preview-09-2025'; 
            const [modelName, setModelName] = useState(defaultModel);
            const [availableModelList, setAvailableModelList] = useState([
                defaultModel,
                'gemini-1.5-flash',
                'gemini-1.5-pro',
                'gemini-1.0-pro'
            ]);
            const [isLoadingModels, setIsLoadingModels] = useState(false);
            
            // UI State
            const [isFetchingUrl, setIsFetchingUrl] = useState(false);
            const [isParsingPdf, setIsParsingPdf] = useState(false);
            const [isGenerating, setIsGenerating] = useState(false);
            const [activeTab, setActiveTab] = useState('input'); // 'input' or 'result'
            const [alertMsg, setAlertMsg] = useState({ type: '', text: '' });

            // Helper: Show Alert
            const showAlert = (type, text) => {
                setAlertMsg({ type, text });
                setTimeout(() => setAlertMsg({ type: '', text: '' }), 5000);
            };
            
            // 0. Fetch Available Models
            const fetchAvailableModels = async () => {
                if (!apiKey) {
                    showAlert('error', 'Please enter your API Key first.');
                    return;
                }
                
                setIsLoadingModels(true);
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`);
                    const data = await response.json();
                    
                    if (data.error) {
                        throw new Error(data.error.message);
                    }
                    
                    if (data.models) {
                        const models = data.models
                            .filter(m => m.supportedGenerationMethods && m.supportedGenerationMethods.includes('generateContent'))
                            .map(m => m.name.replace('models/', ''));
                            
                        if (models.length > 0) {
                            setAvailableModelList(models);
                            setModelName(models.includes(defaultModel) ? defaultModel : models[0]);
                            showAlert('success', `Found ${models.length} available models. Updated list.`);
                        } else {
                            showAlert('error', 'No text generation models found for this API key.');
                        }
                    }
                } catch (err) {
                    console.error(err);
                    showAlert('error', `Could not list models: ${err.message}. Please check your API key and network connection.`);
                } finally {
                    setIsLoadingModels(false);
                }
            };

            // 1. Fetch Job Description from URL
            const fetchJobDescription = async () => {
                if (!jobUrl) {
                    showAlert('error', 'Please enter a URL first.');
                    return;
                }
                
                setIsFetchingUrl(true);
                try {
                    const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(jobUrl)}`);
                    const data = await response.json();
                    
                    if (data.contents) {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(data.contents, 'text/html');
                        
                        const scripts = doc.querySelectorAll('script, style, nav, footer, header');
                        scripts.forEach(s => s.remove());
                        
                        const text = doc.body.innerText || "";
                        const cleanText = text.replace(/\s+/g, ' ').trim().substring(0, 15000);
                        
                        setJobDescription(cleanText);
                        showAlert('success', 'Successfully fetched content from URL. Please verify the text below.');
                    } else {
                        throw new Error("No content found");
                    }
                } catch (err) {
                    console.error(err);
                    showAlert('error', 'Could not fetch URL (likely blocked by the site). Please copy and paste the job description manually.');
                } finally {
                    setIsFetchingUrl(false);
                }
            };

            // 2. Parse PDF Resume
            const handleFileUpload = async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                if (file.type !== 'application/pdf') {
                    showAlert('error', 'Please upload a PDF file.');
                    return;
                }

                setResumeFileName(file.name);
                setIsParsingPdf(true);

                try {
                    const arrayBuffer = await file.arrayBuffer();
                    const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                    
                    let fullText = '';
                    
                    for (let i = 1; i <= pdf.numPages; i++) {
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();
                        const pageText = textContent.items.map(item => item.str).join(' ');
                        fullText += pageText + '\n';
                    }

                    setResumeText(fullText);
                    showAlert('success', 'Resume parsed successfully!');
                } catch (err) {
                    console.error(err);
                    showAlert('error', 'Failed to parse PDF. Please try a different file or copy-paste the text.');
                } finally {
                    setIsParsingPdf(false);
                }
            };

            // 3. Generate Tailored Resume with Gemini
            const generateTailoredResume = async () => {
                if (!apiKey) {
                    showAlert('error', 'Please enter your Gemini API Key.');
                    return;
                }
                if (!jobDescription || jobDescription.length < 50) {
                    showAlert('error', 'Please provide a valid Job Description.');
                    return;
                }
                if (!resumeText || resumeText.length < 50) {
                    showAlert('error', 'Please upload a valid Resume.');
                    return;
                }

                setIsGenerating(true);
                setActiveTab('result'); // Switch to result view to show loading state there

                const prompt = `
                    You are an expert ATS (Applicant Tracking System) optimization specialist and professional resume writer.
                    
                    I will provide you with a JOB DESCRIPTION and a CANDIDATE RESUME.
                    
                    Your task is to rewrite the candidate's resume to tailor it specifically for this job opening.
                    
                    GUIDELINES:
                    1. Highlight skills and experiences from the resume that match the job description.
                    2. Use keywords from the job description naturally to improve ATS ranking.
                    3. Maintain honestyâ€”do not invent experiences, but reframe existing ones to align with the role.
                    4. Use professional, action-oriented language (e.g., "Spearheaded," "Optimized," "Developed").
                    5. Format the output in clean Markdown.
                    6. Include sections: Summary, Skills, Professional Experience, Education.

                    JOB DESCRIPTION:
                    ${jobDescription.substring(0, 10000)}

                    CANDIDATE RESUME:
                    ${resumeText.substring(0, 10000)}
                `;

                try {
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`;
                    
                    const payload = {
                        contents: [{
                            parts: [{ text: prompt }]
                        }]
                    };

                    const data = await callGeminiApi(apiUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payload)
                    });

                    if (!data.candidates || data.candidates.length === 0) {
                        throw new Error("No response generated. Safety settings might have blocked it.");
                    }

                    const generatedText = data.candidates[0].content.parts[0].text;
                    
                    setGeneratedResume(generatedText);
                    showAlert('success', 'Resume generated successfully! Use the "Download .html" button for best formatting when pasting into Word/PDF.');
                    
                } catch (err) {
                    console.error(err);
                    let errorMessage = err.message;
                    if (errorMessage.includes('Quota exceeded')) {
                        errorMessage = "Quota exceeded. Please check your API plan/billing or try again later with a different model.";
                    } else {
                        errorMessage = `Generation failed: ${errorMessage}. Try clicking 'Refresh Models' or checking your API key.`;
                    }
                    showAlert('error', errorMessage);
                    setActiveTab('input'); // Go back to input on error
                } finally {
                    setIsGenerating(false);
                }
            };
            
            // 4. Download Handler - Generates styled HTML
            const downloadResume = () => {
                // 1. Get the styled HTML content from the rendered result area
                const resumeContentHtml = resultRef.current ? resultRef.current.innerHTML : marked.parse(generatedResume);

                // 2. Create a complete, self-contained HTML document with necessary styles
                const htmlTemplate = `
                    <!DOCTYPE html>
                    <html lang="en">
                    <head>
                        <meta charset="UTF-8">
                        <title>Tailored Resume</title>
                        <style>
                            /* Minimal styles for a professional resume look */
                            body { font-family: Arial, sans-serif; line-height: 1.4; color: #1e293b; max-width: 800px; margin: 40px auto; padding: 20px; }
                            h1 { font-size: 1.8em; font-weight: bold; margin-top: 0.5em; margin-bottom: 0.25em; color: #0f172a; border-bottom: 2px solid #e2e8f0; padding-bottom: 0.2em; }
                            h2 { font-size: 1.4em; font-weight: bold; margin-top: 1.5em; margin-bottom: 0.5em; color: #1e293b; border-bottom: 1px solid #f1f5f9; padding-bottom: 0.2em; }
                            h3 { font-size: 1.1em; font-weight: bold; margin-top: 1em; margin-bottom: 0.2em; }
                            ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; }
                            li { margin-bottom: 0.5em; }
                            p { margin-bottom: 1em; line-height: 1.6; }
                            strong { font-weight: 700; }
                        </style>
                    </head>
                    <body>
                        ${resumeContentHtml}
                    </body>
                    </html>
                `;

                // 3. Trigger download
                const element = document.createElement("a");
                const file = new Blob([htmlTemplate], {type: 'text/html'});
                element.href = URL.createObjectURL(file);
                element.download = "tailored_resume.html";
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            };
            
            // 5. Copy Formatted Text Handler
            const copyFormattedText = () => {
                if (resultRef.current) {
                    try {
                        // Select the content of the rendered div
                        const range = document.createRange();
                        range.selectNode(resultRef.current);
                        window.getSelection().removeAllRanges();
                        window.getSelection().addRange(range);
                        
                        // Use execCommand('copy') for better compatibility in Canvas
                        document.execCommand('copy');
                        
                        // Clear selection
                        window.getSelection().removeAllRanges();
                        
                        showAlert('success', 'Formatted resume copied to clipboard! Paste into Word or Google Docs.');
                    } catch (err) {
                        console.error("Copy failed:", err);
                        showAlert('error', 'Failed to copy formatted text. Please use the Download button.');
                    }
                }
            };


            return (
                <div className="max-w-5xl mx-auto p-4 md:p-8">
                    {/* Header */}
                    <div className="mb-8 text-center">
                        <h1 className="text-4xl font-bold text-slate-800 mb-2">AI Resume Tailor</h1>
                        <p className="text-slate-500">Optimize your resume for any job opening in seconds using AI.</p>
                    </div>

                    {/* API Key Input */}
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-6">
                        <label className="block text-sm font-medium text-slate-700 mb-2">
                            Google Gemini API Key <span className="text-red-500">*</span>
                        </label>
                        <div className="flex gap-2 mb-4">
                            <input 
                                type="password" 
                                value={apiKey}
                                onChange={(e) => setApiKey(e.target.value)}
                                placeholder="Enter your AI Studio API Key (begins with AIza...)"
                                className="flex-1 p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none"
                            />
                            <a 
                                href="https://aistudio.google.com/app/apikey" 
                                target="_blank"
                                className="px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md text-sm font-medium flex items-center"
                            >
                                Get Key Free
                            </a>
                        </div>

                        <label className="block text-sm font-medium text-slate-700 mb-2">
                            AI Model Selector
                        </label>
                        <div className="flex gap-2">
                            <select 
                                value={modelName}
                                onChange={(e) => setModelName(e.target.value)}
                                className="flex-1 p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none"
                            >
                                {availableModelList.map(model => (
                                    <option key={model} value={model}>{model}</option>
                                ))}
                            </select>
                            <button 
                                onClick={fetchAvailableModels}
                                disabled={isLoadingModels}
                                className="px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md text-sm font-medium flex items-center whitespace-nowrap"
                                title="Click this if you get 'Model not found' errors"
                            >
                                {isLoadingModels ? <Spinner /> : 'ðŸ”„ Refresh Models'}
                            </button>
                        </div>
                        <p className="text-xs text-slate-400 mt-2">
                            If generation fails with "Model not found" or "Quota exceeded", try clicking <b>Refresh Models</b> or use the default model.
                        </p>
                    </div>

                    <Alert type={alertMsg.type} message={alertMsg.text} onClose={() => setAlertMsg({ type: '', text: '' })} />

                    {/* Main Content Tabs */}
                    <div className="flex border-b border-slate-200 mb-6">
                        <button 
                            onClick={() => setActiveTab('input')}
                            className={`px-6 py-3 font-medium text-sm transition-colors ${activeTab === 'input' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-slate-500 hover:text-slate-700'}`}
                        >
                            1. Input Data
                        </button>
                        <button 
                            onClick={() => setActiveTab('result')}
                            disabled={!generatedResume && !isGenerating}
                            className={`px-6 py-3 font-medium text-sm transition-colors ${activeTab === 'result' ? 'border-b-2 border-blue-500 text-blue-600' : 'text-slate-500 hover:text-slate-700'} ${(!generatedResume && !isGenerating) ? 'opacity-50 cursor-not-allowed' : ''}`}
                        >
                            2. Tailored Resume
                        </button>
                    </div>

                    {activeTab === 'input' && (
                        <div className="grid md:grid-cols-2 gap-6">
                            
                            {/* Column 1: Job Description */}
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col h-[600px]">
                                <h2 className="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
                                    <span className="w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs">A</span>
                                    Job Description
                                </h2>
                                
                                <div className="mb-4">
                                    <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2">Import from URL (Beta)</label>
                                    <div className="flex gap-2">
                                        <input 
                                            type="text" 
                                            value={jobUrl}
                                            onChange={(e) => setJobUrl(e.target.value)}
                                            placeholder="https://www.linkedin.com/jobs/..."
                                            className="flex-1 p-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none"
                                        />
                                        <button 
                                            onClick={fetchJobDescription}
                                            disabled={isFetchingUrl}
                                            className="bg-slate-100 hover:bg-slate-200 text-slate-700 px-3 rounded-md flex items-center justify-center min-w-[40px]"
                                        >
                                            {isFetchingUrl ? <Spinner /> : 'Fetch'}
                                        </button>
                                    </div>
                                    <p className="text-xs text-slate-400 mt-1">Note: Many job sites block bots. If fetch fails, paste text below.</p>
                                </div>

                                <div className="flex-1 flex flex-col">
                                    <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2">Or Paste Text Here</label>
                                    <textarea 
                                        value={jobDescription}
                                        onChange={(e) => setJobDescription(e.target.value)}
                                        placeholder="Paste the full job description here..."
                                        className="flex-1 w-full p-4 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none resize-none font-mono"
                                    ></textarea>
                                </div>
                            </div>

                            {/* Column 2: Resume */}
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col h-[600px]">
                                <h2 className="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
                                    <span className="w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs">B</span>
                                    Your Resume
                                </h2>

                                <div className="mb-4">
                                    <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2">Upload PDF</label>
                                    <div className="relative border-2 border-dashed border-slate-300 rounded-lg p-6 hover:bg-slate-50 transition-colors text-center cursor-pointer">
                                        <input 
                                            type="file" 
                                            accept=".pdf"
                                            onChange={handleFileUpload}
                                            className="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                                        />
                                        <div className="pointer-events-none">
                                            {isParsingPdf ? (
                                                <div className="flex flex-col items-center">
                                                    <Spinner />
                                                    <span className="text-sm text-slate-500 mt-2">Reading PDF...</span>
                                                </div>
                                            ) : (
                                                <>
                                                    <p className="text-sm font-medium text-blue-600">
                                                        {resumeFileName ? resumeFileName : "Click to upload PDF"}
                                                    </p>
                                                    <p className="text-xs text-slate-400 mt-1">
                                                        {resumeFileName ? "File loaded" : "or drag and drop"}
                                                    </p>
                                                </>
                                            )}
                                        </div>
                                    </div>
                                </div>

                                <div className="flex-1 flex flex-col">
                                    <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-2">Parsed Text (Editable)</label>
                                    <textarea 
                                        value={resumeText}
                                        onChange={(e) => setResumeText(e.target.value)}
                                        placeholder="Resume text will appear here after upload..."
                                        className="flex-1 w-full p-4 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none resize-none font-mono"
                                    ></textarea>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Result Tab */}
                    {activeTab === 'result' && (
                        <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 min-h-[600px]">
                            {isGenerating ? (
                                <div className="flex flex-col items-center justify-center h-96">
                                    <div className="w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-6"></div>
                                    <h3 className="text-xl font-semibold text-slate-700">Optimizing Resume...</h3>
                                    <p className="text-slate-500 mt-2">Integrating job keywords and formatting structure.</p>
                                </div>
                            ) : (
                                <div>
                                    <div className="flex justify-between items-center mb-6 pb-4 border-b border-slate-100">
                                        <h2 className="text-xl font-bold text-slate-800">Tailored Resume</h2>
                                        <div className="flex gap-2">
                                            <button 
                                                onClick={copyFormattedText}
                                                className="px-4 py-2 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-md"
                                            >
                                                Copy Formatted Text
                                            </button>
                                            <button 
                                                onClick={downloadResume}
                                                className="px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md"
                                            >
                                                Download .html
                                            </button>
                                        </div>
                                    </div>
                                    {/* The content below will be what is copied/downloaded */}
                                    <div 
                                        ref={resultRef}
                                        className="markdown-body prose max-w-none p-4"
                                        dangerouslySetInnerHTML={{ __html: marked.parse(generatedResume) }}
                                    ></div>
                                </div>
                            )}
                        </div>
                    )}

                    {/* Action Bar (Always visible on Input tab) */}
                    {activeTab === 'input' && (
                        <div className="mt-6 flex justify-end">
                            <button 
                                onClick={generateTailoredResume}
                                disabled={isGenerating}
                                className="bg-blue-600 hover:bg-blue-700 text-white text-lg font-semibold py-3 px-8 rounded-lg shadow-lg transform transition hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
                            >
                                {isGenerating ? 'Processing...' : 'âœ¨ Generate Tailored Resume'}
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>